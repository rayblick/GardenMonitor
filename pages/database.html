

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Database &mdash; Garden Monitor 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Garden Monitor 0.1 documentation" href="../index.html"/>
        <link rel="next" title="API" href="api.html"/>
        <link rel="prev" title="Docs" href="docs.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Garden Monitor
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary.html">Garden Monitor</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Docs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aim">Aim</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-and-open">Install and open</a></li>
<li class="toctree-l2"><a class="reference internal" href="#change-password-for-user-called-postgres">Change password for user called “postgres”</a></li>
<li class="toctree-l2"><a class="reference internal" href="#allow-local-connections">Allow local connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-database">Create database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-user">Create user</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restart-postgres">Restart postgres</a></li>
<li class="toctree-l2"><a class="reference internal" href="#signing-in">Signing in</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="testdata.html">Test data</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactappBuildingBlocks.html">React App: Building blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactappConnection.html">React App: Connection with API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactappBootstrap.html">React App: Bootstrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactappChart.html">React App: Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="xbee.html">Sensors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Garden Monitor</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Database</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/database.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="database">
<h1>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aim">
<h2>Aim<a class="headerlink" href="#aim" title="Permalink to this headline">¶</a></h2>
<p>Setup data storage location.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Setup a postgres database running on your local network. Add a user and allow the new user to have full privileges.</p>
</div>
<div class="section" id="install-and-open">
<h2>Install and open<a class="headerlink" href="#install-and-open" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># search for postgres</span>
sudo apt-cache search postgres

<span class="c1"># install</span>
sudo apt-get install postgresql-9.6

<span class="c1"># open</span>
sudo -u postgres psql postgres
</pre></div>
</div>
</div>
<div class="section" id="change-password-for-user-called-postgres">
<h2>Change password for user called “postgres”<a class="headerlink" href="#change-password-for-user-called-postgres" title="Permalink to this headline">¶</a></h2>
<div class="highlight-psql"><div class="highlight"><pre><span></span><span class="kp">\password</span> <span class="ss">postgres</span>
<span class="go">\q</span>
</pre></div>
</div>
</div>
<div class="section" id="allow-local-connections">
<h2>Allow local connections<a class="headerlink" href="#allow-local-connections" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># step 1</span>
nano /etc/postgresql/9.4/main/pg_hba.conf

<span class="c1"># update the following section...</span>

<span class="c1"># Database administrative login by Unix domain socket</span>
<span class="nb">local</span>   all             postgres                                peer
<span class="c1"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span>
<span class="c1"># &quot;local&quot; is for Unix domain socket connections only</span>
<span class="nb">local</span>   all             all                                     md5

<span class="c1"># IPv4 local connections:</span>
host    all             all             <span class="m">127</span>.0.0.1/32            md5
<span class="c1"># IPv6 local connections:</span>
host    all             all             ::1/128                 md5
<span class="c1"># Allow replication connections from localhost, by a user with the</span>
<span class="c1"># replication privilege.</span>
<span class="c1">#local   replication     postgres                                peer</span>
<span class="c1">#host    replication     postgres        127.0.0.1/32            md5</span>
<span class="c1">#host    replication     postgres        ::1/128                 md5</span>

host    all             all             <span class="m">0</span>.0.0.0/0               md5
host    all             all             ::/0                    md5

<span class="c1"># exit =&gt; ctrl-x &gt; y &gt; enter</span>

<span class="c1"># step 2</span>
nano /etc/postgresql/9.4/main/postgresql.conf

<span class="c1"># locate the following line...</span>
<span class="c1"># listen_addresses = &quot;127.0.0.1&quot;</span>

<span class="c1"># Change to this...</span>
<span class="nv">listen_addresses</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span> <span class="c1">#WARNING: Make sure you uncomment this line by removing the # symbol</span>

<span class="c1"># exit =&gt; ctrl-x &gt; y &gt; enter</span>
</pre></div>
</div>
</div>
<div class="section" id="create-database">
<h2>Create database<a class="headerlink" href="#create-database" title="Permalink to this headline">¶</a></h2>
<p>Start database using user “postgres” (first code block above)</p>
<div class="highlight-psql"><div class="highlight"><pre><span></span><span class="c1">-- list databases</span>
<span class="kp">\l+</span>

<span class="c1">-- create db</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">homesensors</span>


<span class="c1">-- connect</span>
<span class="kp">\c</span> <span class="ss">homesensors</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A database called homesensors is required in the next step. The model we create in the Flask API will be called HomeSensorsData and it will live in the homesensors database.</p>
</div>
</div>
<div class="section" id="create-user">
<h2>Create user<a class="headerlink" href="#create-user" title="Permalink to this headline">¶</a></h2>
<div class="highlight-psql"><div class="highlight"><pre><span></span><span class="c1">-- create</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">ray</span> <span class="k">WITH</span> <span class="k">PASSWORD</span> <span class="s1">&#39;password&#39;</span>

<span class="c1">-- list users</span>
<span class="kp">\dg+</span>

<span class="c1">-- add roles</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="n">ray</span> <span class="k">WITH</span> <span class="n">CREATEROLE</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="n">ray</span> <span class="k">WITH</span> <span class="n">createdb</span><span class="p">;</span>
<span class="go">ALTER USER ray WITH Superuser;</span>

<span class="go">-- add privileges</span>
<span class="go">GRANT ALL PRIVILEGES ON homesensors To ray</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The Flask API requires that the user name “ray” is available to access the database in following steps. If you change this name, and you most likely will, make the appropriate changes to the Flask API. The location for making changes will be highlighted in the next step.</p>
</div>
</div>
<div class="section" id="restart-postgres">
<h2>Restart postgres<a class="headerlink" href="#restart-postgres" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo service postgresql restart
</pre></div>
</div>
</div>
<div class="section" id="signing-in">
<h2>Signing in<a class="headerlink" href="#signing-in" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># sign in with new user</span>
psql homesensors ray

<span class="c1">#Password for user ray:</span>
password
</pre></div>
</div>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>Install SQL client and connect.</p>
<a class="reference internal image-reference" href="../_images/remodb_mobile1.png"><img alt="../_images/remodb_mobile1.png" class="align-center" src="../_images/remodb_mobile1.png" style="width: 300px;" /></a>
<a class="reference internal image-reference" href="../_images/remodb_mobile2.png"><img alt="../_images/remodb_mobile2.png" class="align-center" src="../_images/remodb_mobile2.png" style="width: 300px;" /></a>
<a class="reference internal image-reference" href="../_images/remodb_mobile3.png"><img alt="../_images/remodb_mobile3.png" class="align-center" src="../_images/remodb_mobile3.png" style="width: 300px;" /></a>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docs.html" class="btn btn-neutral" title="Docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ray Blick.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>